<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="license" href="LICENSE.txt">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Astroborn</title>
  <style>
    html, body {
      margin: 0px;
      padding: 0px;
      background-color:#fff0eb;
      color:#0e3116;
    }
    body {
      touch-action: manipulation;
    }
    button {
      border-width: 1px;
      padding: 1px;
    }
    p.spacer {
      height: 100vh;
    }
    #ui {
      height: 100vh;
    }
    #narration {
      height: 73vh;
      overflow-y: scroll;
      margin-left: 1ch;
      margin-right: 1ch;
    }
    #hud {
      height: 27vh;
      overflow-y: scroll;
    }
    #resources {
      height: 2vh;
      display: grid;
      grid-template-columns: 33% 34% 33%;
    }
    #hp_slot { background: #020; display: grid; padding: 1px; }
    #hp      { background: #191; }
    #mp_slot { background: #200; display: grid; padding-top: 1px; padding-bottom: 1px; }
    #mp      { background: #A22; }
    #pp_slot { background: #002; display: grid; padding: 1px; }
    #pp      { background: #33F; }
    #targets {
      height: 6vh;
      display: grid;
      grid-template-columns: 25% 25% 25% 25%;
    }
    #actions {
      height: 19vh;
      display: grid;
      grid-template-columns: 33% 34% 33%;
    }
  </style>
</head>
<body>
  <div id="ui">
    <div id="narration">
      <p class="spacer"></p>
    </div>
    <div id="hud">
      <div id="resources">
        <div id="hp_slot"><div id="hp" style="width: 100%"></div></div>
        <div id="mp_slot"><div id="mp" style="width: 100%"></div></div>
        <div id="pp_slot"><div id="pp" style="width: 100%"></div></div>
      </div>
      <div id="targets">
        <button></button>
        <button></button>
        <button></button>
        <button></button>
      </div>
      <div id="actions">
        <button></button>
        <button></button>
        <button></button>
        <button></button>
        <button></button>
        <button></button>
        <button></button>
        <button></button>
        <button></button>
      </div>
    </div>
  </div>
  <script type="module">
    import { Game } from './game.js'
    const game = new Game()
    game.start()

    window.game = game
    window.ui = game.ui

    // TODO: This can be removed at some point, but serves to illustrate the usage of the targets bar.
    window.demoShowTargetsBar = function demoShowTargetsBar() {
      function demoShowTargetsBarSub(root, parent) {
        ui.targets.setTargets([
          {
            text: 'Do It',
            action: () => {
              ui.targets.restore(root)
            },
          },
          {
            text: 'Don\'t Do It',
            action: () => {
              ui.targets.restore(parent)
            },
          },
        ])
      }

      const root = ui.targets.save()
      ui.targets.setTargets([
        {
          text: 'Target 1',
          action: () => {
            const state = ui.targets.save()
            demoShowTargetsBarSub(root, state)
          },
        },
        {
          text: 'Target 2',
          action: () => {
            const state = ui.targets.save()
            demoShowTargetsBarSub(root, state)
          },
        },
        {
          text: 'Target 3',
          action: () => {
            const state = ui.targets.save()
            demoShowTargetsBarSub(root, state)
          },
        },
        {
          text: 'Target 4',
          action: () => {
            const state = ui.targets.save()
            demoShowTargetsBarSub(root, state)
          },
        },
        {
          text: 'Target 5',
          action: () => {
            const state = ui.targets.save()
            demoShowTargetsBarSub(root, state)
          },
        },
      ])
    }

    // TODO: This can be removed at some point, but serves to illustrate the usage of the actions bar.
    window.demoShowActionsGrid = function demoShowActionsGrid() {
      function showList(prefix, count, state) {
        const items = []
        for (let i = 0; i < count; ++i) {
          const j = i
          items.push({ text: prefix + 'A' + j, action: () => {
            console.log('DID  ' + prefix + 'A' + j)
            const state = ui.actions.save()
            showList(prefix + 'A', j, state)
          }});
        }
        ui.actions.setList(items, state)
      }

      const items = []
      for (let i = 0; i < 9; ++i) {
        const j = i
        items.push({ text: 'Act ' + j, action: () => {
          console.log('Did Act ' + j)
          const state = ui.actions.save()
          showList('A', j, state)
        }});
      }
      ui.actions.setActions(items)
    }
  </script>
</body>
</html>
